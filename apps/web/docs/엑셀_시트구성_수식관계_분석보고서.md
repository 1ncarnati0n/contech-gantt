# 251208 로직입력 데이터 107동 물량기준 엑셀 파일 분석 보고서

## 📋 개요

**파일명**: `251208 로직입력 데이터 107동 물량기준.xlsx`  
**분석 일자**: 2025-01-08  
**분석 내용**: 시트 구성 및 수식 관계 분석

---

## 📊 시트 구성

엑셀 파일은 총 **2개의 시트**로 구성되어 있습니다:

### 1. 동,층별물량표
- **크기**: 52행 × 10열
- **용도**: 107동의 층별 물량 데이터를 저장하는 기본 데이터 시트
- **주요 데이터**:
  - 구분 (버림, 직접기초, 지하골조, 지상골조, PH층 등)
  - 층 정보
  - 갱폼, 알폼, 형틀, 해체/정리, 철근, 콘크리트 등 물량 데이터

### 2. 골조표준공정 일수고정 산식표
- **크기**: 64행 × 25열
- **용도**: 골조 공정의 작업 일수 및 인원 산정을 위한 계산 시트
- **주요 데이터**:
  - 구분별 공정 정보
  - 직영공사 적용 항목
  - 수량, 인당 1일 작업량, 총 작업인원, 1일 투입인원 등
  - 산정 기준, 투입장비명, 장비대수, 직영 순작업일, 간접일, 총작업일수 등

---

## 🔗 시트 간 참조 관계

### 참조 방향
**`골조표준공정 일수고정 산식표`** → **`동,층별물량표`**

- `골조표준공정 일수고정 산식표` 시트의 **28개 셀**에서 `동,층별물량표` 시트의 데이터를 참조합니다.
- 참조는 주로 **D열(수량)**에서 이루어지며, 물량 데이터를 기반으로 작업 일수와 인원을 계산합니다.

### 주요 참조 패턴

#### 1. 직접 참조 (단순 값 가져오기)
```
D4: ='동,층별물량표'!E6    (버림틀설치 수량)
D5: ='동,층별물량표'!H6    (버림타설 수량)
D7: ='동,층별물량표'!G7    (직접기초 철근)
D8: ='동,층별물량표'!E7    (직접기초 형틀)
```

#### 2. 비율 계산 참조 (물량 × 비율)
```
D13: ='동,층별물량표'!G8*0.45    (철근의 45%)
D14: ='동,층별물량표'!E8*0.95    (형틀의 95%)
D15: ='동,층별물량표'!G8*0.55    (철근의 55%)
D16: ='동,층별물량표'!E8*0.05    (형틀의 5%)
D20: ='동,층별물량표'!G9*0.45    (철근의 45%)
D21: ='동,층별물량표'!E9*0.9     (형틀의 90%)
D24: ='동,층별물량표'!H9*0.6     (콘크리트의 60%)
D26: ='동,층별물량표'!H9*0.4     (콘크리트의 40%)
```

#### 3. 전체 참조 목록 (28개)

| 셀 위치 | 참조 수식 | 설명 |
|---------|-----------|------|
| D4 | `='동,층별물량표'!E6` | 버림틀설치 수량 |
| D5 | `='동,층별물량표'!H6` | 버림타설 수량 |
| D7 | `='동,층별물량표'!G7` | 직접기초 철근 |
| D8 | `='동,층별물량표'!E7` | 직접기초 형틀 |
| D9 | `='동,층별물량표'!H7` | 직접기초 콘크리트 |
| D13 | `='동,층별물량표'!G8*0.45` | 철근 45% |
| D14 | `='동,층별물량표'!E8*0.95` | 형틀 95% |
| D15 | `='동,층별물량표'!G8*0.55` | 철근 55% |
| D16 | `='동,층별물량표'!E8*0.05` | 형틀 5% |
| D17 | `='동,층별물량표'!H8` | 콘크리트 |
| D20 | `='동,층별물량표'!G9*0.45` | 철근 45% |
| D21 | `='동,층별물량표'!E9*0.9` | 형틀 90% |
| D22 | `='동,층별물량표'!G9*0.55` | 철근 55% |
| D23 | `='동,층별물량표'!E9*0.05` | 형틀 5% |
| D24 | `='동,층별물량표'!H9*0.6` | 콘크리트 60% |
| D25 | `='동,층별물량표'!E9*0.05` | 형틀 5% |
| D26 | `='동,층별물량표'!H9*0.4` | 콘크리트 40% |
| D31 | `='동,층별물량표'!C11` | 갱폼 |
| D32 | `='동,층별물량표'!G11*0.5` | 철근 50% |
| D33 | `='동,층별물량표'!D11` | 알폼 |
| D34 | `='동,층별물량표'!G11*0.5` | 철근 50% |
| D35 | `='동,층별물량표'!H11` | 콘크리트 |
| D39 | `='동,층별물량표'!C14` | 갱폼 |
| D43 | `='동,층별물량표'!H14` | 콘크리트 |
| D47 | `='동,층별물량표'!G26*0.5` | 철근 50% |
| D48 | `='동,층별물량표'!E26` | 형틀 |
| D49 | `='동,층별물량표'!G26*0.5` | 철근 50% |
| D50 | `='동,층별물량표'!H26` | 콘크리트 |

---

## 📐 수식 관계 분석

### 시트 1: 동,층별물량표

#### 수식 통계
- **총 수식 개수**: 22개
- **SUM 함수**: 5개
- **같은 시트 내 참조**: 13개
- **산술 연산**: 10개

#### 수식 유형

##### 1. 합계 계산 (SUM 함수)
```
C50: =SUM(C6:C49)    (갱폼 합계)
D50: =SUM(D6:D49)    (알폼 합계)
E50: =SUM(E6:E49)    (형틀 합계)
G50: =SUM(G7:G27)    (철근 합계)
H50: =SUM(H6:H49)    (콘크리트 합계)
```

##### 2. 단순 참조 (값 복사)
```
F7: =E7    (해체/정리 = 형틀)
F8: =E8    (해체/정리 = 형틀)
F9: =E9    (해체/정리 = 형틀)
F11: =E11  (해체/정리 = 형틀)
F12: =E12  (해체/정리 = 형틀)
F26: =E26  (해체/정리 = 형틀)
F27: =E27  (해체/정리 = 형틀)
```

##### 3. 산술 연산 (덧셈)
```
H6: =85.63+142.437                    (버림타설 콘크리트 합계)
E7: =260+56.18+58.289                 (직접기초 형틀 합계)
G7: =47.07+63.554                     (직접기초 철근 합계)
E8: =2997.597+1856.972                (직접기초 형틀 합계)
G8: =52.45+65.564                     (직접기초 철근 합계)
H8: =309.62+472.732                   (직접기초 콘크리트 합계)
E9: =3419.37+1652.227                 (직접기초 형틀 합계)
G9: =74.71+77.545                     (직접기초 철근 합계)
H9: =563.5+683.818                    (직접기초 콘크리트 합계)
G39: =#REF!*#REF!                     (오류 - 참조 문제)
```

### 시트 2: 골조표준공정 일수고정 산식표

#### 수식 통계
- **총 수식 개수**: 151개
- **다른 시트 참조**: 28개
- **같은 시트 내 참조**: 120개
- **ROUNDUP 함수**: 93개
- **CEILING 함수**: 8개
- **산술 연산**: 37개

#### 수식 유형

##### 1. 다른 시트 참조 (물량 데이터 가져오기)
- 위의 "시트 간 참조 관계" 섹션 참조

##### 2. 작업량 계산 (나눗셈)
```
F4: =D4/E4    (총작업인원 = 수량 / 인당 1일 작업량)
F7: =ROUNDUP(D7/E7,0)    (총작업인원, 올림)
F8: =ROUNDUP(D8/E8,0)    (총작업인원, 올림)
```

##### 3. 일수 계산 (ROUNDUP 함수)
```
G4: =ROUNDUP(F4/K4,0)    (1일 투입인원 = 총작업인원 / 장비대수, 올림)
G7: =ROUNDUP(F7/K7,0)
G8: =ROUNDUP(F8/K8,0)
M4: =ROUNDUP(K4+L4, 0)   (총작업일수 = 직영 순작업일 + 간접일, 올림)
```

##### 4. 복잡한 조건부 계산 (IF, MAX, MIN, CEILING 함수)
```
J5: =CEILING(MIN(2, D5/H11), 1)    (최대 2, 최소 1로 제한)

K5: =MAX(1,
    IF(D5/(E5*G5) - INT(D5/(E5*G5)) < 0.5,
        ROUNDDOWN(D5/(E5*G5),0),
        ROUNDUP(D5/(E5*G5),0)
    )
)    (반올림 로직: 소수점이 0.5 미만이면 내림, 이상이면 올림, 최소값 1)
```

##### 5. 곱셈 연산
```
F5: =G5*K5    (총작업인원 = 1일 투입인원 × 장비대수)
G5: =J5*5     (1일 투입인원 = 산정 기준 × 5)
D18: =D14+D16 (수량 합계)
```

---

## 🔍 주요 수식 패턴 요약

### 1. 물량 데이터 집계
- **동,층별물량표**: SUM 함수로 각 항목별 합계 계산
- **합계 위치**: 50행 (C50, D50, E50, G50, H50)

### 2. 작업 일수 산정
- **기본 공식**: `총작업인원 = 수량 / 인당 1일 작업량`
- **올림 처리**: ROUNDUP 함수로 소수점 올림
- **최소값 보장**: MAX(1, ...) 함수로 최소 1일 보장

### 3. 인원 산정
- **기본 공식**: `1일 투입인원 = 총작업인원 / 장비대수`
- **조건부 계산**: 소수점 처리에 따라 ROUNDDOWN 또는 ROUNDUP 선택
- **제한값**: CEILING, MIN, MAX 함수로 범위 제한

### 4. 비율 분할
- 물량 데이터를 비율로 분할하여 여러 공정에 배분
- 예: 철근을 45%와 55%로 분할, 형틀을 95%와 5%로 분할

---

## ⚠️ 주의사항

1. **오류 셀**: `동,층별물량표` 시트의 G39 셀에 `=#REF!*#REF!` 오류가 있습니다.
   - **확인 결과**: G39 셀에 실제로 `=#REF!*#REF!` 수식이 존재하며, 계산된 값도 `#REF!` 오류입니다.
   - **원인 분석**: 
     - 39행은 완전히 비어있는 행입니다 (A39~H39 모두 데이터 없음).
     - 원래 G39 셀이 다른 셀들을 참조하는 곱셈 수식이었으나, 참조하던 셀들이 삭제되어 `#REF!` 오류가 발생한 것으로 추정됩니다.
     - G열의 다른 수식들은 모두 덧셈(G7, G8, G9) 또는 SUM 함수(G50)인데, G39만 곱셈 수식입니다.
   - **영향도**: 
     - G50의 SUM 수식 범위가 `G7:G27`이므로 G39는 합계 계산에 포함되지 않습니다.
     - 따라서 현재 오류가 다른 계산에 영향을 미치지 않습니다.
   - **조치 권장사항**: 
     - 39행이 비어있고 다른 계산에 사용되지 않으므로, G39 셀의 수식을 삭제하거나 빈 셀로 만드는 것을 권장합니다.
2. **참조 의존성**: `골조표준공정 일수고정 산식표` 시트는 `동,층별물량표` 시트의 데이터에 완전히 의존합니다.
3. **수식 복잡도**: `골조표준공정 일수고정 산식표` 시트의 수식이 복잡하므로, 수정 시 주의가 필요합니다.

---

## 📌 결론

이 엑셀 파일은 **2단계 구조**로 구성되어 있습니다:

1. **데이터 입력 단계** (`동,층별물량표`): 층별 물량 데이터를 입력하고 합계를 계산
2. **계산 단계** (`골조표준공정 일수고정 산식표`): 물량 데이터를 기반으로 작업 일수, 인원, 장비 등을 산정

두 시트는 **단방향 참조 관계**를 가지며, 물량 데이터가 변경되면 자동으로 작업 일수와 인원이 재계산됩니다.

